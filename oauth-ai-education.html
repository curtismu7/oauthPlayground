<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OAuth 2.0 & OIDC for AI Applications</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        nav {
            background: #34495e;
            padding: 15px 40px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 5px;
            transition: background 0.3s;
            font-weight: 500;
        }
        
        nav a:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .content {
            padding: 40px;
        }
        
        section {
            margin-bottom: 50px;
        }
        
        h2 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }
        
        h3 {
            color: #34495e;
            font-size: 1.5em;
            margin: 25px 0 15px 0;
        }
        
        h4 {
            color: #546e7a;
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }
        
        p {
            margin-bottom: 15px;
            color: #555;
        }
        
        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left: 4px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .future-box {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left: 4px solid #4caf50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .code-block {
            background: #263238;
            color: #aed581;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        .flow-diagram {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        
        .flow-step {
            background: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 15px;
            margin: 10px auto;
            max-width: 600px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .arrow {
            color: #667eea;
            font-size: 2em;
            margin: 10px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background: #f5f5f5;
        }
        
        .tag {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            margin: 5px 5px 5px 0;
            font-weight: 500;
        }
        
        .tag.security { background: #e74c3c; }
        .tag.privacy { background: #9b59b6; }
        .tag.future { background: #27ae60; }
        .tag.standard { background: #3498db; }
        
        footer {
            background: #2c3e50;
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .card h4 {
            color: #667eea;
            margin-top: 0;
        }

        @media (max-width: 768px) {
            header h1 { font-size: 1.8em; }
            .content { padding: 20px; }
            nav ul { flex-direction: column; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê OAuth 2.0 & OpenID Connect for AI</h1>
            <p>A Comprehensive Guide to Authentication & Authorization in the Age of AI</p>
        </header>
        
        <nav>
            <ul>
                <li><a href="#basics">Basics</a></li>
                <li><a href="#flows">Flows</a></li>
                <li><a href="#current-standards">Current Standards</a></li>
                <li><a href="#ai-considerations">AI Considerations</a></li>
                <li><a href="#security">Security</a></li>
                <li><a href="#future">Future</a></li>
            </ul>
        </nav>
        
        <div class="content">
            <section id="basics">
                <h2>Understanding the Basics</h2>
                
                <h3>What is OAuth 2.0?</h3>
                <p>OAuth 2.0 is an authorization framework that enables applications to obtain limited access to user accounts on an HTTP service. It works by delegating user authentication to the service that hosts the user account and authorizing third-party applications to access that user account.</p>
                
                <div class="info-box">
                    <strong>Key Concept:</strong> OAuth 2.0 is about <strong>authorization</strong> (what you can do), not authentication (who you are). That's where OpenID Connect comes in.
                </div>
                
                <h3>What is OpenID Connect (OIDC)?</h3>
                <p>OpenID Connect is an identity layer built on top of OAuth 2.0. It allows clients to verify the identity of end-users based on authentication performed by an authorization server, and to obtain basic profile information about the end-user.</p>
                
                <div class="grid">
                    <div class="card">
                        <h4>OAuth 2.0</h4>
                        <p><strong>Purpose:</strong> Authorization</p>
                        <p><strong>Question:</strong> "What can this app access?"</p>
                        <p><strong>Output:</strong> Access tokens</p>
                    </div>
                    <div class="card">
                        <h4>OpenID Connect</h4>
                        <p><strong>Purpose:</strong> Authentication</p>
                        <p><strong>Question:</strong> "Who is this user?"</p>
                        <p><strong>Output:</strong> ID tokens (JWT)</p>
                    </div>
                </div>
                
                <h3>Key Terminology</h3>
                <table>
                    <tr>
                        <th>Term</th>
                        <th>Definition</th>
                    </tr>
                    <tr>
                        <td><strong>Resource Owner</strong></td>
                        <td>The user who owns the data (you)</td>
                    </tr>
                    <tr>
                        <td><strong>Client</strong></td>
                        <td>The application requesting access (the AI app)</td>
                    </tr>
                    <tr>
                        <td><strong>Authorization Server</strong></td>
                        <td>The server that authenticates the user and issues tokens</td>
                    </tr>
                    <tr>
                        <td><strong>Resource Server</strong></td>
                        <td>The API that holds the protected resources</td>
                    </tr>
                    <tr>
                        <td><strong>Access Token</strong></td>
                        <td>Credential used to access protected resources</td>
                    </tr>
                    <tr>
                        <td><strong>Refresh Token</strong></td>
                        <td>Long-lived token used to obtain new access tokens</td>
                    </tr>
                    <tr>
                        <td><strong>ID Token</strong></td>
                        <td>JWT containing user identity information (OIDC)</td>
                    </tr>
                </table>
            </section>
            
            <section id="flows">
                <h2>OAuth 2.0 Grant Types & Flows</h2>
                
                <h3>1. Authorization Code Flow (Recommended for AI Apps)</h3>
                <div class="flow-diagram">
                    <div class="flow-step">
                        <strong>Step 1:</strong> User clicks "Login" in AI app
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">
                        <strong>Step 2:</strong> App redirects to Authorization Server with client_id, redirect_uri, scope, state
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">
                        <strong>Step 3:</strong> User authenticates and consents to permissions
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">
                        <strong>Step 4:</strong> Authorization Server redirects back with authorization code
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">
                        <strong>Step 5:</strong> App exchanges code for tokens (access + refresh + ID token)
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">
                        <strong>Step 6:</strong> App uses access token to call APIs
                    </div>
                </div>
                
                <div class="code-block">
// Step 2: Authorization Request
GET /authorize?
  response_type=code&
  client_id=ai_app_123&
  redirect_uri=https://aiapp.com/callback&
  scope=openid profile email ai:read ai:write&
  state=xyz123&
  code_challenge=E9Melhoa...&
  code_challenge_method=S256

// Step 5: Token Exchange
POST /token
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&
code=abc123&
redirect_uri=https://aiapp.com/callback&
client_id=ai_app_123&
client_secret=secret&
code_verifier=dBjftJeZ...
                </div>
                
                <h3>2. Authorization Code Flow with PKCE</h3>
                <div class="info-box">
                    <strong>PKCE (Proof Key for Code Exchange):</strong> Essential security extension that prevents authorization code interception attacks. <strong>Required for public clients</strong> (SPAs, mobile apps, desktop apps).
                    <br><br>
                    <span class="tag security">Security</span>
                    <span class="tag standard">RFC 7636</span>
                </div>
                
                <div class="code-block">
// Generate PKCE values
const codeVerifier = generateRandomString(43-128 chars);
const codeChallenge = base64url(sha256(codeVerifier));

// Include in authorization request
code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM
code_challenge_method=S256

// Include verifier in token request
code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk
                </div>
                
                <h3>3. Client Credentials Flow (AI-to-AI Communication)</h3>
                <p>Used when the AI application itself needs to access resources, not on behalf of a user. Common for background AI agents, batch processing, and service-to-service communication.</p>
                
                <div class="code-block">
POST /token
Content-Type: application/x-www-form-urlencoded

grant_type=client_credentials&
client_id=ai_service_456&
client_secret=service_secret&
scope=ai:process ai:analyze
                </div>
                
                <h3>4. Device Authorization Flow (AI Devices & IoT)</h3>
                <p>For input-constrained devices like AI assistants, smart displays, or IoT devices that don't have a browser.</p>
                
                <div class="flow-diagram">
                    <div class="flow-step">Device requests device code from authorization server</div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">Server returns device code, user code, and verification URL</div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">Device displays user code and verification URL</div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">User visits URL on another device and enters code</div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step">Device polls token endpoint until user completes authorization</div>
                </div>
            </section>
            
            <section id="current-standards">
                <h2>Current Standards & Best Practices</h2>
                
                <h3>Pushed Authorization Requests (PAR) - RFC 9126</h3>
                <span class="tag standard">RFC 9126</span>
                <span class="tag security">Security</span>
                
                <div class="info-box">
                    <strong>What is PAR?</strong> Instead of passing authorization parameters in the URL, the client POSTs them directly to the authorization server and receives a request URI. This significantly improves security and privacy.
                </div>
                
                <h4>Why PAR Matters for AI:</h4>
                <div class="grid">
                    <div class="card">
                        <h4>üîí Enhanced Security</h4>
                        <p>Authorization parameters are never exposed in browser history, logs, or referrer headers</p>
                    </div>
                    <div class="card">
                        <h4>üì¶ Large Payloads</h4>
                        <p>AI apps often need extensive scopes and metadata - PAR removes URL length limits</p>
                    </div>
                    <div class="card">
                        <h4>üõ°Ô∏è Parameter Integrity</h4>
                        <p>Authorization server validates all parameters before user interaction</p>
                    </div>
                </div>
                
                <div class="code-block">
// Step 1: Push Authorization Request
POST /as/par
Content-Type: application/x-www-form-urlencoded
Authorization: Basic czZCaGRSa3F0Mzo...

response_type=code&
client_id=ai_app_123&
redirect_uri=https://aiapp.com/callback&
scope=openid profile email ai:read ai:write ai:train&
code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM&
code_challenge_method=S256&
state=xyz123

// Response
{
  "request_uri": "urn:ietf:params:oauth:request_uri:bwc4JK-ESC0w8acc191e-Y1LTC2",
  "expires_in": 90
}

// Step 2: Authorization Request (simplified)
GET /authorize?
  client_id=ai_app_123&
  request_uri=urn:ietf:params:oauth:request_uri:bwc4JK-ESC0w8acc191e-Y1LTC2
                </div>
                
                <h3>Rich Authorization Requests (RAR) - RFC 9396</h3>
                <span class="tag standard">RFC 9396</span>
                
                <p>Allows clients to specify fine-grained authorization requirements beyond simple scopes. Critical for AI applications that need granular permissions.</p>
                
                <div class="code-block">
{
  "authorization_details": [
    {
      "type": "ai_model_access",
      "actions": ["read", "execute"],
      "models": ["gpt-4", "claude-3"],
      "datatypes": ["text", "image"],
      "max_tokens": 100000
    },
    {
      "type": "user_data_access",
      "locations": ["https://api.example.com/profile"],
      "actions": ["read"],
      "datatypes": ["personal_info"],
      "purpose": "ai_personalization"
    },
    {
      "type": "ai_training",
      "actions": ["read", "analyze"],
      "data_retention": "session_only",
      "anonymization": true
    }
  ]
}
                </div>
                
                <h3>OAuth 2.1 (Draft)</h3>
                <span class="tag future">Future Standard</span>
                
                <p>OAuth 2.1 consolidates best practices and deprecates insecure flows. Key changes:</p>
                
                <ul style="margin-left: 40px; margin-bottom: 20px;">
                    <li>PKCE required for all OAuth clients</li>
                    <li>Implicit flow removed</li>
                    <li>Resource Owner Password Credentials flow removed</li>
                    <li>Bearer token usage clarifications</li>
                    <li>Redirect URI must be exact match</li>
                    <li>Refresh token rotation recommended</li>
                </ul>
                
                <h3>JWT Best Practices - RFC 8725</h3>
                <span class="tag standard">RFC 8725</span>
                
                <div class="code-block">
// ID Token Structure (OIDC)
{
  "iss": "https://auth.example.com",
  "sub": "user_12345",
  "aud": "ai_app_123",
  "exp": 1735689600,
  "iat": 1735686000,
  "nonce": "abc123",
  "email": "user@example.com",
  "email_verified": true,
  "name": "Jane Doe",
  "ai_consent": {
    "data_usage": true,
    "model_training": false,
    "retention_days": 90
  }
}

// Best Practices:
// 1. Always validate "iss", "aud", "exp"
// 2. Use "nonce" to prevent replay attacks
// 3. Verify signature using JWKS
// 4. Use short expiration times (5-15 minutes)
                </div>
                
                <h3>Token Introspection - RFC 7662</h3>
                <p>Allows resource servers to query authorization servers about the current state of an access token. Essential for real-time validation in AI systems.</p>
                
                <div class="code-block">
POST /introspect
Content-Type: application/x-www-form-urlencoded
Authorization: Basic ...

token=2YotnFZFEjr1zCsicMWpAA&
token_type_hint=access_token

// Response
{
  "active": true,
  "scope": "openid profile ai:read ai:write",
  "client_id": "ai_app_123",
  "username": "user@example.com",
  "token_type": "Bearer",
  "exp": 1735689600,
  "iat": 1735686000,
  "sub": "user_12345",
  "aud": "https://api.example.com",
  "iss": "https://auth.example.com"
}
                </div>
                
                <h3>Token Revocation - RFC 7009</h3>
                <p>Allows clients to notify the authorization server that a token is no longer needed. Critical for AI apps when users revoke consent.</p>
            </section>
            
            <section id="ai-considerations">
                <h2>AI-Specific Requirements & Considerations</h2>
                
                <h3>Consent Management for AI</h3>
                <div class="warning-box">
                    <strong>Critical for AI:</strong> Users must provide explicit, granular consent for how their data will be used in AI systems. This goes beyond traditional OAuth scopes.
                </div>
                
                <h4>AI-Specific Scopes</h4>
                <table>
                    <tr>
                        <th>Scope</th>
                        <th>Purpose</th>
                        <th>User Consent Required</th>
                    </tr>
                    <tr>
                        <td><code>ai:read</code></td>
                        <td>AI can read user data for inference</td>
                        <td>‚úì Yes</td>
                    </tr>
                    <tr>
                        <td><code>ai:analyze</code></td>
                        <td>AI can analyze patterns in user data</td>
                        <td>‚úì Yes</td>
                    </tr>
                    <tr>
                        <td><code>ai:train</code></td>
                        <td>Use data for model training</td>
                        <td>‚úì‚úì Explicit consent</td>
                    </tr>
                    <tr>
                        <td><code>ai:personalize</code></td>
                        <td>Store preferences for personalization</td>
                        <td>‚úì Yes</td>
                    </tr>
                    <tr>
                        <td><code>ai:generate</code></td>
                        <td>Generate content using user context</td>
                        <td>‚úì Yes</td>
                    </tr>
                    <tr>
                        <td><code>ai:share_insights</code></td>
                        <td>Share anonymized insights with third parties</td>
                        <td>‚úì‚úì Explicit consent</td>
                    </tr>
                </table>
                
                <h3>Data Retention & Purpose Limitation</h3>
                <p>AI applications must clearly communicate data retention policies through OAuth metadata.</p>
                
                <div class="code-block">
// Extended Authorization Request for AI
{
  "authorization_details": [
    {
      "type": "ai_processing",
      "purpose": "personalized_recommendations",
      "data_retention": {
        "duration_days": 90,
        "deletion_policy": "automatic",
        "anonymization_after_days": 30
      },
      "model_training": false,
      "third_party_sharing": false,
      "data_minimization": true,
      "processing_location": "us-east-1"
    }
  ],
  "user_consent_version": "2.1",
  "privacy_policy_url": "https://aiapp.com/privacy",
  "data_usage_transparency_url": "https://aiapp.com/data-usage"
}
                </div>
                
                <h3>Context and Session Management</h3>
                <p>AI systems often maintain long-running conversations and context. OAuth tokens must support this with appropriate lifetimes.</p>
                
                <div class="grid">
                    <div class="card">
                        <h4>Short-Lived Access Tokens</h4>
                        <p>15-60 minutes for API calls</p>
                        <p><strong>Why:</strong> Limits exposure if compromised</p>
                    </div>
                    <div class="card">
                        <h4>Refresh Token Rotation</h4>
                        <p>New refresh token with each use</p>
                        <p><strong>Why:</strong> Detects token theft</p>
                    </div>
                    <div class="card">
                        <h4>Session Tokens</h4>
                        <p>Separate tokens for conversational state</p>
                        <p><strong>Why:</strong> Doesn't expose API credentials</p>
                    </div>
                </div>
                
                <h3>Delegation and Agent Authorization</h3>
                <p>AI agents may need to act on behalf of users across multiple services. This requires careful delegation management.</p>
                
                <div class="code-block">
// Token Exchange for AI Agents (RFC 8693)
POST /token
Content-Type: application/x-www-form-urlencoded

grant_type=urn:ietf:params:oauth:grant-type:token-exchange&
subject_token=user_access_token&
subject_token_type=urn:ietf:params:oauth:token-type:access_token&
actor_token=ai_agent_token&
actor_token_type=urn:ietf:params:oauth:token-type:access_token&
scope=downstream_api:access&
requested_token_type=urn:ietf:params:oauth:token-type:access_token&
audience=https://downstream-api.example.com
                </div>
                
                <h3>Privacy-Preserving AI Authentication</h3>
                <span class="tag privacy">Privacy</span>
                <span class="tag future">Emerging</span>
                
                <h4>Zero-Knowledge Proofs</h4>
                <p>Allow AI systems to verify user attributes without learning the attributes themselves.</p>
                
                <h4>Federated Learning Credentials</h4>
                <p>Authenticate contributions to federated learning without revealing individual data sources.</p>
                
                <h4>Differential Privacy Tokens</h4>
                <p>Tokens that encode privacy budgets for AI queries against sensitive datasets.</p>
                
                <h3>Multi-Modal AI Authentication</h3>
                <p>As AI systems process multiple data types, OAuth must support varied resource types:</p>
                
                <ul style="margin-left: 40px; margin-bottom: 20px;">
                    <li><strong>Text:</strong> Messages, documents, emails</li>
                    <li><strong>Images:</strong> Photos, diagrams, screenshots</li>
                    <li><strong>Audio:</strong> Voice recordings, music</li>
                    <li><strong>Video:</strong> Calls, recordings</li>
                    <li><strong>Structured Data:</strong> Databases, spreadsheets</li>
                    <li><strong>Real-time Streams:</strong> Sensor data, live feeds</li>
                </ul>
                
                <div class="code-block">
{
  "authorization_details": [
    {
      "type": "multimodal_ai_access",
      "modalities": ["text", "image", "audio"],
      "actions": ["read", "analyze", "generate"],
      "quality_requirements": {
        "image_min_resolution": "1024x1024",
        "audio_sample_rate": 44100
      },
      "processing_constraints": {
        "max_batch_size": 100,
        "timeout_seconds": 30
      }
    }
  ]
}
                </div>
            </section>
            
            <section id="security">
                <h2>Security Considerations for AI Systems</h2>
                
                <h3>OAuth 2.0 Security Best Current Practice (BCP) - RFC 8252</h3>
                <span class="tag security">Security</span>
                <span class="tag standard">RFC 8252</span>
                
                <div class="warning-box">
                    <strong>Critical Security Requirements:</strong>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Always use HTTPS for all communications</li>
                        <li>Implement PKCE for all authorization code flows</li>