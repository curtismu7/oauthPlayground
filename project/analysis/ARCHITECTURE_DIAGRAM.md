# Architecture Diagram - OAuth Playground

## High-Level System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FRONTEND LAYER (React 18)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Pages Layer    â”‚  â”‚  Components      â”‚  â”‚   Routes         â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ Flows (v8/v7m) â”‚  â”‚ â€¢ UI Components  â”‚  â”‚ â€¢ App.tsx        â”‚      â”‚
â”‚  â”‚ â€¢ Callbacks      â”‚  â”‚ â€¢ Device Flows   â”‚  â”‚ â€¢ Router Config  â”‚      â”‚
â”‚  â”‚ â€¢ Dashboard      â”‚  â”‚ â€¢ Token Display  â”‚  â”‚ â€¢ Lazy Routes    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚               Context & State Management (Zustand + React)       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ Flow Context  â€¢ Auth Context  â€¢ MFA State  â€¢ Token State       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICES LAYER (Business Logic)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Flow Services   â”‚  â”‚  Auth Services   â”‚  â”‚ Storage Services â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ v8Integration  â”‚  â”‚ â€¢ MFA Service    â”‚  â”‚ â€¢ v8Storage      â”‚      â”‚
â”‚  â”‚ â€¢ v7Shared       â”‚  â”‚ â€¢ OIDC Service   â”‚  â”‚ â€¢ Worker Token   â”‚      â”‚
â”‚  â”‚ â€¢ FlowContext    â”‚  â”‚ â€¢ Client Auth    â”‚  â”‚ â€¢ Credential     â”‚      â”‚
â”‚  â”‚ â€¢ FlowValidation â”‚  â”‚ â€¢ Auth Methods   â”‚  â”‚ â€¢ Session Store  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   Token Services â”‚  â”‚   API Services   â”‚  â”‚  Utility Servicesâ”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ TOTP Token     â”‚  â”‚ â€¢ PAR Service    â”‚  â”‚ â€¢ Logger         â”‚      â”‚
â”‚  â”‚ â€¢ Token Exchange â”‚  â”‚ â€¢ Device Auth    â”‚  â”‚ â€¢ Config         â”‚      â”‚
â”‚  â”‚ â€¢ Token Inspect  â”‚  â”‚ â€¢ Discovery      â”‚  â”‚ â€¢ Export/Import  â”‚      â”‚
â”‚  â”‚ â€¢ JWT Validation â”‚  â”‚ â€¢ Client Creds   â”‚  â”‚ â€¢ Postman Gen    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Cross-Cutting Concerns                         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ Error Handling  â€¢ Validation  â€¢ Analytics  â€¢ Security          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND API LAYER (Express.js)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   API Routes     â”‚  â”‚   Middleware     â”‚  â”‚   Auth Handlers  â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ OAuth Routes   â”‚  â”‚ â€¢ CORS           â”‚  â”‚ â€¢ JWT Verify     â”‚      â”‚
â”‚  â”‚ â€¢ Token Routes   â”‚  â”‚ â€¢ Logging        â”‚  â”‚ â€¢ Session Check  â”‚      â”‚
â”‚  â”‚ â€¢ Config Routes  â”‚  â”‚ â€¢ Error Handler  â”‚  â”‚ â€¢ Rate Limit     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EXTERNAL SERVICES (PingOne APIs & 3rd Party)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  PingOne APIs    â”‚  â”‚  OAuth Providers â”‚  â”‚   Utilities      â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ Auth Server    â”‚  â”‚ â€¢ Callbacks      â”‚  â”‚ â€¢ QR Code Gen    â”‚      â”‚
â”‚  â”‚ â€¢ Token Endpoint â”‚  â”‚ â€¢ Redirects      â”‚  â”‚ â€¢ Email Service  â”‚      â”‚
â”‚  â”‚ â€¢ UserInfo       â”‚  â”‚ â€¢ Sessions       â”‚  â”‚ â€¢ SMS Gateway    â”‚      â”‚
â”‚  â”‚ â€¢ Management API â”‚  â”‚ â€¢ PKCE           â”‚  â”‚ â€¢ Crypto Utils   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STORAGE LAYER (Client & Server)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   localStorage   â”‚  â”‚ sessionStorage   â”‚  â”‚  IndexedDB       â”‚      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”‚
â”‚  â”‚ â€¢ Credentials    â”‚  â”‚ â€¢ Session Data   â”‚  â”‚ â€¢ Large Data     â”‚      â”‚
â”‚  â”‚ â€¢ Tokens         â”‚  â”‚ â€¢ Temp State     â”‚  â”‚ â€¢ Cache          â”‚      â”‚
â”‚  â”‚ â€¢ Preferences    â”‚  â”‚ â€¢ Flow State     â”‚  â”‚ â€¢ Offline Data   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Server-Side Storage (File System)                    â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ Logs  â€¢ Certificates  â€¢ Configuration  â€¢ Temp Files            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Module Organization

```
src/
â”‚
â”œâ”€â”€ v8u/                          # Unified OAuth Flow V8 (Latest - BROKEN)
â”‚   â”œâ”€â”€ flows/                    # Flow implementations
â”‚   â”œâ”€â”€ components/               # V8U-specific components
â”‚   â”œâ”€â”€ services/                 # V8U services
â”‚   â”œâ”€â”€ pages/                    # V8U pages
â”‚   â””â”€â”€ utils/                    # V8U utilities (HAS SYNTAX ERRORS)
â”‚
â”œâ”€â”€ v8/                           # MFA & OAuth V8 (Production)
â”‚   â”œâ”€â”€ flows/                    # MFA flows
â”‚   â”‚   â”œâ”€â”€ types/               # Device-specific flows (SMS, Email, TOTP, FIDO2)
â”‚   â”‚   â””â”€â”€ components/          # Flow components
â”‚   â”œâ”€â”€ services/                # MFA services
â”‚   â”œâ”€â”€ pages/                   # MFA pages
â”‚   â””â”€â”€ controllers/             # Flow controllers
â”‚
â”œâ”€â”€ v7m/                          # Legacy Mobile Flows
â”‚   â”œâ”€â”€ flows/
â”‚   â””â”€â”€ services/
â”‚
â”œâ”€â”€ components/                   # 200+ Shared UI Components
â”‚   â”œâ”€â”€ device/                  # Device-specific UI
â”‚   â”œâ”€â”€ display/                 # Display components
â”‚   â”œâ”€â”€ flow/                    # Flow components
â”‚   â”œâ”€â”€ mfa/                     # MFA components
â”‚   â”œâ”€â”€ token/                   # Token display
â”‚   â””â”€â”€ ui/                      # Base UI components
â”‚
â”œâ”€â”€ pages/                        # Page Components
â”‚   â”œâ”€â”€ flows/                   # OAuth flow implementations
â”‚   â”œâ”€â”€ callbacks/               # OAuth callbacks
â”‚   â”œâ”€â”€ Dashboard.tsx            # Main dashboard
â”‚   â””â”€â”€ JWKSTroubleshooting.tsx # Token debugging
â”‚
â”œâ”€â”€ services/                     # 100+ Service Classes
â”‚   â”œâ”€â”€ flowContextService.ts    # Flow state management
â”‚   â”œâ”€â”€ authMethodService.tsx    # Auth method selection
â”‚   â”œâ”€â”€ v8StorageService.ts      # Token storage
â”‚   â”œâ”€â”€ mfaServiceV8.ts          # MFA orchestration
â”‚   â”œâ”€â”€ parService.ts            # PAR implementation
â”‚   â”œâ”€â”€ postmanCollectionGeneratorV8.ts  # Postman export
â”‚   â””â”€â”€ [90+ more services]
â”‚
â”œâ”€â”€ hooks/                        # Custom React Hooks (50+)
â”‚   â”œâ”€â”€ useMFAFlow/
â”‚   â”œâ”€â”€ useOAuthFlow/
â”‚   â””â”€â”€ [Custom hooks for all major features]
â”‚
â”œâ”€â”€ utils/                        # Utility Functions (118+)
â”‚   â”œâ”€â”€ tokenUtils.ts
â”‚   â”œâ”€â”€ cryptoUtils.ts
â”‚   â”œâ”€â”€ storageUtils.ts
â”‚   â””â”€â”€ [More utilities]
â”‚
â”œâ”€â”€ contexts/                     # React Contexts (4+)
â”‚   â”œâ”€â”€ FlowContext.tsx
â”‚   â”œâ”€â”€ AuthContext.tsx
â”‚   â””â”€â”€ [More contexts]
â”‚
â”œâ”€â”€ types/                        # TypeScript Type Definitions
â”‚   â”œâ”€â”€ oauth.ts
â”‚   â”œâ”€â”€ mfa.ts
â”‚   â””â”€â”€ [More types]
â”‚
â”œâ”€â”€ styles/                       # Global Styling
â”‚   â”œâ”€â”€ theme.ts
â”‚   â”œâ”€â”€ GlobalStyles.ts
â”‚   â””â”€â”€ [CSS utilities]
â”‚
â””â”€â”€ App.tsx                       # Root Component
```

---

## Data Flow Diagram

```
USER INTERACTION
       â†“
   PAGE/COMPONENT
       â†“
   CUSTOM HOOKS
       â†“
   STATE MANAGEMENT (Context/Zustand)
       â†“
   SERVICES LAYER
       â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â†“                    â†“              â†“
API CALLS         STORAGE OPS     LOGGING/ANALYTICS
   â†“                    â†“              â†“
EXTERNAL APIS      localStorage    Event Tracking
(PingOne)          IndexedDB
                   sessionStorage
```

---

## Service Interaction Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVICE DEPENDENCIES                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  FlowContextService
â”‚    â”œâ”€â”€ uses: v8StorageService, authMethodService
â”‚    â”œâ”€â”€ used by: UnifiedFlowIntegrationV8U, Flow components
â”‚    â””â”€â”€ manages: Flow state, context validation
â”‚
â”‚  MFAServiceV8
â”‚    â”œâ”€â”€ uses: v8StorageService, authMethodService, deviceServices
â”‚    â”œâ”€â”€ used by: MFA flows, MFA pages
â”‚    â””â”€â”€ manages: MFA device orchestration
â”‚
â”‚  v8StorageService
â”‚    â”œâ”€â”€ uses: localStorage, sessionStorage, IndexedDB
â”‚    â”œâ”€â”€ used by: all auth services, flow services
â”‚    â””â”€â”€ manages: Token persistence, credentials
â”‚
â”‚  authMethodService
â”‚    â”œâ”€â”€ uses: v8StorageService, config service
â”‚    â”œâ”€â”€ used by: MFA, OAuth flows
â”‚    â””â”€â”€ manages: Auth method selection and validation
â”‚
â”‚  PARService
â”‚    â”œâ”€â”€ uses: API client, v8StorageService
â”‚    â”œâ”€â”€ used by: OAuth flows, authorization
â”‚    â””â”€â”€ manages: Pushed Authorization Requests
â”‚
â”‚  UnifiedFlowIntegrationV8U
â”‚    â”œâ”€â”€ uses: FlowContextService, v8StorageService, all other services
â”‚    â”œâ”€â”€ used by: V8U flows
â”‚    â””â”€â”€ manages: Unified flow orchestration (FACADE PATTERN)
â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Version Strategy

```
CURRENT VERSIONS:
â”œâ”€â”€ V8U (Latest - Unified)
â”‚   â”œâ”€â”€ Status: ğŸ”´ BROKEN (syntax errors)
â”‚   â”œâ”€â”€ Files: ~50
â”‚   â””â”€â”€ Purpose: Single unified OAuth flow with all features
â”‚
â”œâ”€â”€ V8 (Production - MFA)
â”‚   â”œâ”€â”€ Status: ğŸŸ¢ STABLE
â”‚   â”œâ”€â”€ Files: ~400
â”‚   â””â”€â”€ Purpose: Complete MFA implementations (SMS, TOTP, Email, FIDO2)
â”‚
â”œâ”€â”€ V7M (Legacy Mobile)
â”‚   â”œâ”€â”€ Status: ğŸŸ¢ STABLE
â”‚   â”œâ”€â”€ Files: ~50
â”‚   â””â”€â”€ Purpose: Mobile-optimized legacy flows
â”‚
â””â”€â”€ V7 (Legacy)
    â”œâ”€â”€ Status: ğŸŸ¡ MAINTAINED
    â”œâ”€â”€ Files: Minimal (shared services)
    â””â”€â”€ Purpose: Original OAuth flow implementations
```

---

## Testing Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         VITEST (Unit & Integration)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Service tests                         â”‚
â”‚ â€¢ Hook tests                            â”‚
â”‚ â€¢ Utility function tests                â”‚
â”‚ â€¢ Component unit tests                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      PLAYWRIGHT (E2E Testing)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Full flow testing                     â”‚
â”‚ â€¢ OAuth callback handling               â”‚
â”‚ â€¢ Multi-step process validation         â”‚
â”‚ â€¢ Browser automation                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CODE QUALITY CHECKS             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Biome linting                         â”‚
â”‚ â€¢ ESLint rules                          â”‚
â”‚ â€¢ TypeScript compilation                â”‚
â”‚ â€¢ Prettier formatting                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Component Hierarchy Example (Unified Flow)

```
App
 â””â”€â”€ Router
      â””â”€â”€ UnifiedOAuthFlowV8U (1867 lines)
           â”œâ”€â”€ FlowTypeSelector
           â”œâ”€â”€ SpecVersionSelector
           â”œâ”€â”€ CredentialsFormV8U
           â”œâ”€â”€ UnifiedFlowSteps (8316 lines - needs refactoring)
           â”‚    â”œâ”€â”€ Step0: Introduction
           â”‚    â”œâ”€â”€ Step1: Configuration
           â”‚    â”œâ”€â”€ Step2: Authorization
           â”‚    â”œâ”€â”€ Step3: Token Exchange
           â”‚    â”œâ”€â”€ Step4: Validation
           â”‚    â””â”€â”€ Step5: Security
           â”œâ”€â”€ FlowStateDisplay
           â”œâ”€â”€ TokenDisplay
           â””â”€â”€ ErrorBoundary
```

---

## Build & Deployment Pipeline

```
SOURCE CODE (2053 files, 380k LOC)
         â†“
   LINT & FORMAT (Biome)
    âœ“ or âœ— (FAILING)
         â†“
  TYPE CHECKING (TypeScript)
    âœ“ or âœ— (FAILING due to syntax errors)
         â†“
    UNIT TESTS (Vitest)
         â†“
  E2E TESTS (Playwright)
         â†“
   BUILD (Vite)
         â†“
  BUNDLE ANALYSIS
         â†“
  DEPLOYMENT (Vercel/Netlify)
    â””â”€â”€ Available targets: Multiple environments
```

---

## Key Integration Points

```
1. PingOne API Integration
   â”œâ”€â”€ Authorization endpoint
   â”œâ”€â”€ Token endpoint
   â”œâ”€â”€ UserInfo endpoint
   â””â”€â”€ Management API

2. OAuth Provider Integration
   â”œâ”€â”€ Authorization Code Flow
   â”œâ”€â”€ Implicit Flow
   â”œâ”€â”€ Client Credentials Flow
   â”œâ”€â”€ Device Authorization Flow
   â””â”€â”€ Hybrid Flow

3. MFA Integration
   â”œâ”€â”€ SMS OTP
   â”œâ”€â”€ TOTP
   â”œâ”€â”€ Email OTP
   â”œâ”€â”€ FIDO2/WebAuthn
   â””â”€â”€ Security Keys

4. Storage Integration
   â”œâ”€â”€ Browser localStorage
   â”œâ”€â”€ sessionStorage
   â”œâ”€â”€ IndexedDB (for larger data)
   â””â”€â”€ Server-side file system

5. External Services
   â”œâ”€â”€ Email service (for OTP)
   â”œâ”€â”€ SMS gateway (for SMS OTP)
   â”œâ”€â”€ QR code generator
   â””â”€â”€ Crypto libraries
```

---

This architecture supports:
- âœ… Multiple OAuth/OIDC flow types
- âœ… Comprehensive MFA capabilities
- âœ… Educational content delivery
- âœ… Token lifecycle management
- âœ… Cross-browser storage
- âœ… Mobile-optimized flows
- âœ… Easy environment configuration
- âŒ Currently blocked by syntax errors in V8U module
