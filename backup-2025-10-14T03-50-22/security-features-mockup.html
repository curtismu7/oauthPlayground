<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Features Demo - Mockup</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        .header h1 {
            margin: 0 0 0.5rem 0;
            font-size: 2rem;
            font-weight: 700;
        }
        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: 1.1rem;
        }
        .content {
            padding: 2rem;
        }
        .section {
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
        }
        .section-header {
            background: #f8fafc;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 600;
            color: #374151;
        }
        .section-content {
            padding: 1.5rem;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .feature-card {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            background: #fafbfc;
        }
        .feature-title {
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        .status-enabled {
            background: #dcfce7;
            color: #166534;
        }
        .status-required {
            background: #fef3c7;
            color: #92400e;
        }
        .feature-description {
            color: #6b7280;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        .demo-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .demo-button:hover {
            background: #2563eb;
        }
        .demo-button.danger {
            background: #ef4444;
        }
        .demo-button.danger:hover {
            background: #dc2626;
        }
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.85rem;
            overflow-x: auto;
            margin: 1rem 0;
        }
        .parameter-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 0.5rem 1rem;
            margin: 1rem 0;
        }
        .param-label {
            font-weight: 600;
            color: #374151;
        }
        .param-value {
            font-family: 'Monaco', 'Menlo', monospace;
            background: #f1f5f9;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            word-break: break-all;
        }
        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .info-title {
            font-weight: 600;
            color: #1e40af;
            margin-bottom: 0.5rem;
        }
        .info-text {
            color: #1e40af;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí Security Features Demonstration</h1>
            <p>Advanced OAuth 2.0 and OpenID Connect Security Implementations</p>
        </div>
        
        <div class="content">
            <!-- Request Parameter Signature Section -->
            <div class="section">
                <div class="section-header">
                    üìù Request Parameter Signature Requirements
                </div>
                <div class="section-content">
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-title">
                                Request Parameter Signature
                                <span class="status-badge status-required">Required</span>
                            </div>
                            <div class="feature-description">
                                Ensures request integrity by requiring cryptographic signatures on all OAuth requests.
                            </div>
                            <button class="demo-button" onclick="showSignatureDemo()">
                                üîç View Signature Demo
                            </button>
                            <button class="demo-button" onclick="validateSignature()">
                                ‚úÖ Validate Current Request
                            </button>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-title">
                                x5t Parameter Inclusion
                                <span class="status-badge status-enabled">Enabled</span>
                            </div>
                            <div class="feature-description">
                                Includes X.509 certificate thumbprint in JWT headers for enhanced security.
                            </div>
                            <button class="demo-button" onclick="showX5tDemo()">
                                üîë View x5t in Tokens
                            </button>
                            <button class="demo-button" onclick="verifyCertificate()">
                                üõ°Ô∏è Verify Certificate
                            </button>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <div class="info-title">How Request Signatures Work</div>
                        <div class="info-text">
                            Request parameter signatures use HMAC-SHA256 to create a cryptographic signature of the request parameters. 
                            This prevents tampering and ensures request authenticity. The signature is included in the Authorization header.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Token Security Features -->
            <div class="section">
                <div class="section-header">
                    üé´ Token Security Features
                </div>
                <div class="section-content">
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-title">
                                JWT Header Security
                                <span class="status-badge status-enabled">Active</span>
                            </div>
                            <div class="feature-description">
                                Enhanced JWT headers with x5t, kid, and other security parameters.
                            </div>
                            <div class="parameter-grid">
                                <div class="param-label">Algorithm:</div>
                                <div class="param-value">RS256</div>
                                <div class="param-label">Key ID:</div>
                                <div class="param-value">kid-12345-rsa-1</div>
                                <div class="param-label">x5t (SHA-1):</div>
                                <div class="param-value">NzbLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs</div>
                                <div class="param-label">x5t#S256:</div>
                                <div class="param-value">TjzbdLsXh8uDCcd-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs</div>
                            </div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-title">
                                Token Validation
                                <span class="status-badge status-enabled">Active</span>
                            </div>
                            <div class="feature-description">
                                Real-time token validation with signature verification and expiration checks.
                            </div>
                            <button class="demo-button" onclick="validateAllTokens()">
                                üîç Validate All Tokens
                            </button>
                            <button class="demo-button" onclick="checkTokenExpiry()">
                                ‚è∞ Check Expiration
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Session Management -->
            <div class="section">
                <div class="section-header">
                    üö™ Session Management & Termination
                </div>
                <div class="section-content">
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-title">
                                Session Termination
                                <span class="status-badge status-enabled">Available</span>
                            </div>
                            <div class="feature-description">
                                Securely terminate user sessions using ID tokens and logout endpoints.
                            </div>
                            <button class="demo-button danger" onclick="terminateSession()">
                                üö™ Terminate Session
                            </button>
                            <button class="demo-button" onclick="showLogoutUrl()">
                                üîó View Logout URL
                            </button>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-title">
                                Token Revocation
                                <span class="status-badge status-enabled">Available</span>
                            </div>
                            <div class="feature-description">
                                Revoke access and refresh tokens to immediately invalidate them.
                            </div>
                            <button class="demo-button danger" onclick="revokeTokens()">
                                ‚ùå Revoke All Tokens
                            </button>
                            <button class="demo-button" onclick="revokeRefreshToken()">
                                üîÑ Revoke Refresh Token
                            </button>
                        </div>
                    </div>
                    
                    <div class="code-block" id="logoutUrl" style="display: none;">
https://auth.pingone.com/{{environmentId}}/as/revoke
?client_id={{clientId}}
&token={{accessToken}}
&token_type_hint=access_token
&id_token_hint={{idToken}}
                    </div>
                </div>
            </div>

            <!-- CORS Settings & Testing -->
            <div class="section">
                <div class="section-header">
                    üåê CORS Settings & Testing
                </div>
                <div class="section-content">
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-title">
                                CORS Configuration
                                <span class="status-badge status-required">Restricted</span>
                            </div>
                            <div class="feature-description">
                                Configure Cross-Origin Resource Sharing (CORS) settings to control which domains can access your OAuth endpoints.
                            </div>
                            
                            <div class="cors-config">
                                <div class="parameter-grid">
                                    <div class="param-label">CORS Policy:</div>
                                    <div class="param-value">
                                        <select class="cors-dropdown" style="width: 100%; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background: white;">
                                            <option value="specific">Allow specific origins</option>
                                            <option value="any">Allow any CORS-safe origin</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="origins-section">
                                    <div class="param-label">Allowed Origins:</div>
                                    <div class="origin-item" style="display: flex; align-items: center; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 0.375rem; margin: 0.5rem 0;">
                                        <span style="font-family: monospace; font-size: 0.9rem;">https://localhost:3000</span>
                                        <button style="background: none; border: none; color: #ef4444; cursor: pointer; padding: 0.25rem;">üóëÔ∏è</button>
                                    </div>
                                    <div class="origin-item" style="display: flex; align-items: center; justify-content: space-between; padding: 0.5rem; background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 0.375rem; margin: 0.5rem 0;">
                                        <span style="font-family: monospace; font-size: 0.9rem;">https://app.example.com</span>
                                        <button style="background: none; border: none; color: #ef4444; cursor: pointer; padding: 0.25rem;">üóëÔ∏è</button>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                                        <input type="text" placeholder="https://example.com" style="flex: 1; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem;">
                                        <button class="demo-button">+ Add</button>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 1rem;">
                                    <button class="demo-button" onclick="testCorsConfiguration()">
                                        ‚ñ∂Ô∏è Test CORS Configuration
                                    </button>
                                    <button class="demo-button danger" onclick="demonstrateCorsError()">
                                        ‚ö†Ô∏è Demonstrate CORS Error
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-title">
                                CORS Test Results
                                <span class="status-badge status-enabled">Available</span>
                            </div>
                            <div class="feature-description">
                                View the results of CORS policy testing across different origins.
                            </div>
                            
                            <div class="test-results">
                                <div class="test-result" style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 0.375rem; margin: 0.5rem 0;">
                                    <div>
                                        <div style="font-family: monospace; font-size: 0.9rem; font-weight: 500;">https://localhost:3000</div>
                                    </div>
                                    <div style="color: #16a34a; font-weight: bold;">‚úì Allowed</div>
                                </div>
                                <div class="test-result" style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: #fef2f2; border: 1px solid #fecaca; border-radius: 0.375rem; margin: 0.5rem 0;">
                                    <div>
                                        <div style="font-family: monospace; font-size: 0.9rem; font-weight: 500;">https://malicious-site.com</div>
                                        <div style="font-size: 0.8rem; color: #dc2626; margin-top: 0.25rem;">CORS policy blocks this origin</div>
                                    </div>
                                    <div style="color: #dc2626; font-weight: bold;">‚úó Blocked</div>
                                </div>
                                <div class="test-result" style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 0.375rem; margin: 0.5rem 0;">
                                    <div>
                                        <div style="font-family: monospace; font-size: 0.9rem; font-weight: 500;">https://app.example.com</div>
                                    </div>
                                    <div style="color: #16a34a; font-weight: bold;">‚úì Allowed</div>
                                </div>
                                <div class="test-result" style="display: flex; align-items: center; justify-content: space-between; padding: 0.75rem; background: #fef2f2; border: 1px solid #fecaca; border-radius: 0.375rem; margin: 0.5rem 0;">
                                    <div>
                                        <div style="font-family: monospace; font-size: 0.9rem; font-weight: 500;">http://localhost:3001</div>
                                        <div style="font-size: 0.8rem; color: #dc2626; margin-top: 0.25rem;">CORS policy blocks this origin</div>
                                    </div>
                                    <div style="color: #dc2626; font-weight: bold;">‚úó Blocked</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-box">
                        <div class="info-title">How CORS Protection Works</div>
                        <div class="info-text">
                            CORS (Cross-Origin Resource Sharing) prevents malicious websites from making unauthorized requests to your OAuth endpoints. 
                            When configured properly, only trusted origins can access your APIs, protecting against CSRF attacks and data theft.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Security Analysis -->
            <div class="section">
                <div class="section-header">
                    üìä Security Analysis & Recommendations
                </div>
                <div class="section-content">
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-title">
                                Current Security Score
                                <span class="status-badge status-enabled">95/100</span>
                            </div>
                            <div class="feature-description">
                                Your OAuth implementation has excellent security practices.
                            </div>
                            <div class="parameter-grid">
                                <div class="param-label">Request Signatures:</div>
                                <div class="param-value">‚úÖ Implemented</div>
                                <div class="param-label">Certificate Validation:</div>
                                <div class="param-value">‚úÖ Active</div>
                                <div class="param-label">Token Encryption:</div>
                                <div class="param-value">‚úÖ RS256</div>
                                <div class="param-label">Session Management:</div>
                                <div class="param-value">‚úÖ Secure</div>
                            </div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-title">
                                Recommendations
                                <span class="status-badge status-required">Review</span>
                            </div>
                            <div class="feature-description">
                                Additional security enhancements you can implement.
                            </div>
                            <ul style="margin: 0; padding-left: 1.5rem; color: #6b7280; font-size: 0.9rem;">
                                <li>Consider implementing PKCE for public clients</li>
                                <li>Enable token binding for additional security</li>
                                <li>Implement rate limiting on token endpoints</li>
                                <li>Add audit logging for security events</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div style="text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #e2e8f0;">
                <button class="demo-button" onclick="exportSecurityReport()" style="margin-right: 1rem;">
                    üìÑ Export Security Report
                </button>
                <button class="demo-button" onclick="runSecurityTest()" style="margin-right: 1rem;">
                    üß™ Run Security Test Suite
                </button>
                <button class="demo-button" onclick="viewDocumentation()">
                    üìö View Documentation
                </button>
            </div>
        </div>
    </div>

    <script>
        function showSignatureDemo() {
            alert('Request Parameter Signature Demo:\n\n1. Generate HMAC-SHA256 signature of request parameters\n2. Include signature in Authorization header\n3. Server validates signature before processing request\n\nThis prevents parameter tampering and ensures request authenticity.');
        }
        
        function validateSignature() {
            alert('‚úÖ Current request signature is valid!\n\nSignature: a1b2c3d4e5f6...\nAlgorithm: HMAC-SHA256\nStatus: Verified');
        }
        
        function showX5tDemo() {
            alert('x5t Parameter Demo:\n\nJWT Header contains:\n- x5t: SHA-1 thumbprint of signing certificate\n- x5t#S256: SHA-256 thumbprint\n- kid: Key identifier for key rotation\n\nThis enables certificate validation and key management.');
        }
        
        function verifyCertificate() {
            alert('üîê Certificate Verification:\n\n‚úÖ Certificate is valid\n‚úÖ Not expired\n‚úÖ Issued by trusted CA\n‚úÖ Key usage matches requirements\n\nCertificate thumbprint matches x5t in JWT header.');
        }
        
        function validateAllTokens() {
            alert('üîç Token Validation Results:\n\n‚úÖ Access Token: Valid (expires in 1h 23m)\n‚úÖ Refresh Token: Valid (expires in 30d)\n‚úÖ ID Token: Valid (expires in 1h 23m)\n\nAll tokens have valid signatures and are not expired.');
        }
        
        function checkTokenExpiry() {
            alert('‚è∞ Token Expiration Status:\n\nAccess Token: 1h 23m remaining\nRefresh Token: 29d 12h remaining\nID Token: 1h 23m remaining\n\nAll tokens are within acceptable expiration windows.');
        }
        
        function terminateSession() {
            if (confirm('Are you sure you want to terminate the current session? This will log out the user and invalidate all tokens.')) {
                alert('üö™ Session terminated successfully!\n\n- User logged out\n- All tokens invalidated\n- Session cleared\n- Redirected to logout URL');
            }
        }
        
        function showLogoutUrl() {
            document.getElementById('logoutUrl').style.display = 'block';
        }
        
        function revokeTokens() {
            if (confirm('Are you sure you want to revoke all tokens? This will immediately invalidate access and refresh tokens.')) {
                alert('‚ùå All tokens revoked successfully!\n\n- Access token invalidated\n- Refresh token invalidated\n- User must re-authenticate\n- Session terminated');
            }
        }
        
        function revokeRefreshToken() {
            if (confirm('Are you sure you want to revoke the refresh token? This will prevent token renewal.')) {
                alert('üîÑ Refresh token revoked successfully!\n\n- Refresh token invalidated\n- Access token will expire normally\n- User must re-authenticate for new tokens');
            }
        }
        
        function exportSecurityReport() {
            alert('üìÑ Security Report exported!\n\nReport includes:\n- Security configuration\n- Token analysis\n- Certificate details\n- Recommendations\n- Compliance status');
        }
        
        function runSecurityTest() {
            alert('üß™ Security Test Suite Results:\n\n‚úÖ Request signature validation: PASS\n‚úÖ Token signature verification: PASS\n‚úÖ Certificate validation: PASS\n‚úÖ Session management: PASS\n‚úÖ Token expiration: PASS\n\nOverall: 5/5 tests passed');
        }
        
        function viewDocumentation() {
            alert('üìö Opening security documentation...\n\nThis would open the comprehensive security features documentation covering:\n- Request parameter signatures\n- JWT security enhancements\n- Session management\n- Best practices');
        }
        
        function testCorsConfiguration() {
            // Simulate toast notification instead of alert
            showToast('üåê CORS Test Complete: 2 origins blocked by CORS policy\n\n‚úÖ https://localhost:3000 - Allowed\n‚ùå https://malicious-site.com - Blocked\n‚úÖ https://app.example.com - Allowed\n‚ùå http://localhost:3001 - Blocked\n\nCORS policy is working correctly to protect your OAuth endpoints!', 'warning');
        }
        
        function demonstrateCorsError() {
            // Simulate toast notification instead of alert
            showToast('üö´ CORS Error Demonstration\n\nAccess to fetch at \'https://api.pingone.com/oauth/token\' from origin \'https://malicious-site.com\' has been blocked by CORS policy: The request client is not a secure context and the resource is in a cross-origin context.\n\nThis is exactly what CORS protection prevents!', 'error');
        }
        
        // Toast notification simulation
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? '#fef2f2' : type === 'warning' ? '#fef3c7' : '#eff6ff'};
                color: ${type === 'error' ? '#991b1b' : type === 'warning' ? '#92400e' : '#1e40af'};
                border: 1px solid ${type === 'error' ? '#fecaca' : type === 'warning' ? '#fde68a' : '#bfdbfe'};
                border-radius: 8px;
                padding: 16px;
                max-width: 400px;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
                white-space: pre-line;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                toast.style.transition = 'all 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 5000);
        }
    </script>
</body>
</html>
